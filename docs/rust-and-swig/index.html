<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>Rust and Swig</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="Just my thoughts, right or wrong" />
    <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/png" />
    <link rel="canonical" href="/rust-and-swig/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Jonathan Harrington" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Rust and Swig" />
    <meta property="og:description" content="Just my thoughts, right or wrong" />
    <meta property="og:url" content="/rust-and-swig/" />
    <meta property="og:image" content="/images/rust.jpeg" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Rust and Swig" />
    <meta name="twitter:description" content="Just my thoughts, right or wrong" />
    <meta name="twitter:url" content="/" />
    <meta name="twitter:image" content="/images/rust.jpeg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Jonathan Harrington" />
    <meta name="twitter:site" content="@jonathanharring" />
    <meta name="twitter:creator" content="@jonathanharring" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="666" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Jonathan Harrington",
        "logo": "/"
    },
    "url": "/rust-and-swig/",
    "image": {
        "@type": "ImageObject",
        "url": "/images/rust.jpeg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/rust-and-swig/"
    },
    "description": "Just my thoughts, right or wrong"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="Rust and Swig" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="/">Jonathan Harrington</a>
            
        
        
            <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
                <a class="social-link social-link-tgh" href="https://github.com/prio" target="_blank" rel="noopener"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub icon</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>
            
            
                <a class="social-link social-link-tli" href="https://www.linkedin.com/in/jnharrington" target="_blank" rel="noopener"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn icon</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a>
                                    
            
                <a class="social-link social-link-tw" href="https://twitter.com/jonathanharring" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
            
        </div>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  post ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 2 August 2018"> 2 August 2018</time>
                    
                </section>
                <h1 class="post-full-title">Rust and Swig</h1>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/images/rust.jpeg)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <p>For a personal project I am working on I wanted to create Python bindings to a Rust library I am creating. The first port of call was <a href="https://github.com/getsentry/milksnake" title="Milksnake">Milksnake</a> and I wrote a Python wrapper to make it nicer to consume. However, a few weeks later I wanted wrappers for a few more languages and rather than create each one individually I decided to see if I could use a tried and trusted tool like <a href="http://swig.org/" title="SWIG">Swig</a>. What follows is a short tutorial on how to use Swig to create bindings for a Rust library.
<!--excerpt--></p>

<h2 id="the-rmath-library">The rmath library</h2>

<p>We will write a simple library with one function that takes two integers and adds them, returning the sum. First we create a new Rust crate.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">cargo init <span class="nt">--lib</span> rmath</code></pre></figure>

<p>We add the following function to <code class="highlighter-rouge">src/lib.rs</code> and edit the test:</p>

<figure class="highlight"><pre><code class="language-rust" data-lang="rust"><span class="k">pub</span> <span class="k">fn</span> <span class="nf">sum</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">u32</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">u32</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">u32</span> <span class="p">{</span>
  <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="p">}</span>

<span class="nd">#[cfg(test)]</span>
<span class="k">mod</span> <span class="n">tests</span> <span class="p">{</span>
    <span class="k">use</span> <span class="nn">super</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>
    
    <span class="nd">#[test]</span>
    <span class="k">fn</span> <span class="nf">it_works</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">assert_eq!</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">4</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>And now run cargo test to make sure it all works.</p>

<h3 id="the-rmath-c-library">The rmath C library</h3>

<p>Now we need to expose this as a C API. We could edit our sum function so it is C compatible but it would make usage from Rust awkward. We could also just add another function to this crate that exposes a C compatible version but if you are creating a real library a nicer way to do it is to create a new crate that contains the C api.</p>

<p>Run</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">cargo init —-lib rmath-c</code></pre></figure>

<p>to create the crate for our C API. We need to update our Cargo.toml file with our dependencies and we need to tell cargo we want to build a C shared library.</p>

<figure class="highlight"><pre><code class="language-toml" data-lang="toml"><span class="nn">[lib]</span>
<span class="py">name</span> <span class="p">=</span> <span class="s">"rmath_c"</span>
<span class="py">crate-type</span> <span class="p">=</span> <span class="nn">["cdylib"]</span>

<span class="nn">[build-dependencies]</span>
<span class="py">cbindgen</span> <span class="p">=</span> <span class="s">"0.6"</span>

<span class="nn">[dependencies]</span>
<span class="py">rmath</span> <span class="p">=</span> <span class="err">{</span> <span class="err">version</span> <span class="err">=</span> <span class="s">"0.1.0"</span><span class="p">,</span> <span class="err">path</span> <span class="err">=</span> <span class="s">".."</span> <span class="err">}</span>
<span class="py">libc</span> <span class="p">=</span> <span class="s">"0.2"</span></code></pre></figure>

<p>Now, we will create a C “friendly” function in <code class="highlighter-rouge">src/lib.rs</code> that we use to expose our sum function.</p>

<figure class="highlight"><pre><code class="language-rust" data-lang="rust"><span class="k">extern</span> <span class="n">crate</span> <span class="n">libc</span><span class="p">;</span>
<span class="k">extern</span> <span class="n">crate</span> <span class="n">rmath</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">libc</span><span class="p">::{</span><span class="nb">c_int</span><span class="p">};</span>

<span class="nd">#[no_mangle]</span>
<span class="k">pub</span> <span class="k">extern</span> <span class="s">"C"</span> <span class="k">fn</span> <span class="nf">sum</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">c_int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">c_int</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">c_int</span> <span class="p">{</span>
    <span class="nn">rmath</span><span class="p">::</span><span class="nf">sum</span><span class="p">(</span><span class="n">a</span> <span class="k">as</span> <span class="nb">u32</span><span class="p">,</span> <span class="n">b</span> <span class="k">as</span> <span class="nb">u32</span><span class="p">)</span> <span class="k">as</span> <span class="nb">i32</span>    
<span class="p">}</span></code></pre></figure>

<p>Next build the crate and make sure it compiles. You should now have a shared library in <code class="highlighter-rouge">target/debug/</code> (called librmath_c.dylib on OS X).</p>

<p>Now we need to use cbindgen to create a C header file. Create a new file called <code class="highlighter-rouge">build.rs</code> in the same folder as your Cargo.toml file.</p>

<figure class="highlight"><pre><code class="language-rust" data-lang="rust"><span class="k">extern</span> <span class="n">crate</span> <span class="n">cbindgen</span><span class="p">;</span>

<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">env</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="n">crate_dir</span> <span class="o">=</span> <span class="nn">env</span><span class="p">::</span><span class="nf">var</span><span class="p">(</span><span class="s">"CARGO_MANIFEST_DIR"</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">config</span><span class="p">:</span> <span class="nn">cbindgen</span><span class="p">::</span><span class="n">Config</span> <span class="o">=</span> <span class="nn">Default</span><span class="p">::</span><span class="nf">default</span><span class="p">();</span>
    <span class="n">config</span><span class="py">.language</span> <span class="o">=</span> <span class="nn">cbindgen</span><span class="p">::</span><span class="nn">Language</span><span class="p">::</span><span class="n">C</span><span class="p">;</span>
    <span class="nn">cbindgen</span><span class="p">::</span><span class="nf">generate_with_config</span><span class="p">(</span><span class="o">&amp;</span><span class="n">crate_dir</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
      <span class="nf">.unwrap</span><span class="p">()</span>
      <span class="nf">.write_to_file</span><span class="p">(</span><span class="s">"target/rmath.h"</span><span class="p">);</span>
<span class="p">}</span></code></pre></figure>

<p>And add <code class="highlighter-rouge">build = "build.rs"</code> to the package section of your Cargo.toml file.</p>

<figure class="highlight"><pre><code class="language-toml" data-lang="toml"><span class="nn">[package]</span>
<span class="py">name</span> <span class="p">=</span> <span class="s">"rmath-c"</span>
<span class="py">build</span> <span class="p">=</span> <span class="s">"build.rs"</span></code></pre></figure>

<p>Running cargo build again should create <code class="highlighter-rouge">target/rmath.h</code>.</p>

<h3 id="swig">Swig</h3>

<p>Finally, we will use Swig to create a Python and r bindings. First install Swig using the instructions on its <a href="http://swig.org/" title="SWIG">website</a>.</p>

<p>Then create a swig file called <code class="highlighter-rouge">rmath.i</code> and add the following:</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="o">%</span><span class="n">module</span> <span class="n">rmath</span>
<span class="o">%</span><span class="p">{</span>
<span class="cp">#include "rmath.h"
</span><span class="o">%</span><span class="p">}</span>
<span class="o">%</span><span class="n">include</span> <span class="s">"rmath.h"</span></code></pre></figure>

<p>This tells Swig our module is called rmath, we want to include rmath.h and we want to wrap the functions defined in rmath.h.</p>

<p>First we will build the Python package, these commands can be added to a Makefile if desired.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">mkdir python
cp target/debug/librmath_c.dylib python/librmath.so
cp rmath.i python/
swig <span class="nt">-python</span> <span class="nt">-outdir</span> python python/rmath.i
gcc <span class="nt">-fPIC</span> <span class="nt">-Wno-register</span> <span class="nt">-Wall</span> <span class="nt">-c</span> <span class="nt">-o</span> python/rmath_wrap.o python/rmath_wrap.c <span class="nt">-Ipython</span>/ <span class="sb">`</span>python2-config <span class="nt">--includes</span><span class="sb">`</span>
gcc <span class="nt">-Wno-deprecated-register</span> <span class="nt">-shared</span> <span class="nt">-o</span> python/_rmath.so python/rmath_wrap.o <span class="nt">-Lpython</span>/ <span class="nt">-lrmath</span> <span class="nt">-lpython</span></code></pre></figure>

<p>Now we cd into the python folder and fire up Python:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">Python 2.7.14 |Anaconda, Inc.| <span class="o">(</span>default, Oct 5 2017, 02:28:52<span class="o">)</span>
<span class="o">[</span>GCC 4.2.1 Compatible Clang 4.0.1 <span class="o">(</span>tags/RELEASE_401/final<span class="o">)]</span> on darwin
Type <span class="s2">"help"</span>, <span class="s2">"copyright"</span>, <span class="s2">"credits"</span> or <span class="s2">"license"</span> <span class="k">for </span>more information.
<span class="o">&gt;&gt;&gt;</span> import rmath
Fatal Python error: PyThreadState_Get: no current thread
Abort <span class="nb">trap</span>: 6</code></pre></figure>

<p>Oh! If you get an error like this it means the version of Python you linked against is different to the one you are running. By specifying ‘-lpython’ it is likely you linked against your default system Python rather than another install that may be in your path, so we you may need to try again using your system Python.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">Python 2.7.10 <span class="o">(</span>default, Feb 7 2017, 00:08:15<span class="o">)</span>
<span class="o">[</span>GCC 4.2.1 Compatible Apple LLVM 8.0.0 <span class="o">(</span>clang-800.0.34<span class="o">)]</span> on darwin
Type <span class="s2">"help"</span>, <span class="s2">"copyright"</span>, <span class="s2">"credits"</span> or <span class="s2">"license"</span> <span class="k">for </span>more information.
<span class="o">&gt;&gt;&gt;</span> import rmath
<span class="o">&gt;&gt;&gt;</span> rmath.sum<span class="o">(</span>2, 3<span class="o">)</span>
5</code></pre></figure>

<p>Excellent. You can now package up <code class="highlighter-rouge">rmath.py</code> and <code class="highlighter-rouge">_rmath.so</code> and use your Rust library from Python.</p>

<p>Finally, we will use the same swig file to create r bindings.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">mkdir r
cp target/debug/librmath_c.dylib r/librmath.so
cp target/rmath.h r/rmath.h
cp rmath.i r/
swig <span class="nt">-r</span> <span class="nt">-outdir</span> r r/rmath.i	
<span class="nv">PKG_LIBS</span><span class="o">=</span><span class="s2">"r/librmath.so"</span> R CMD SHLIB r/rmath_wrap.c <span class="nt">-o</span> r/rmath.so</code></pre></figure>

<p>Now if we cd into the r folder and fire up the r interperator:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">R version 3.5.1 <span class="o">(</span>2018-07-02<span class="o">)</span> <span class="nt">--</span> <span class="s2">"Feather Spray"</span>
Type <span class="s1">'q()'</span> to quit R.

<span class="o">&gt;</span> dyn.load<span class="o">(</span>paste<span class="o">(</span><span class="s2">"rmath"</span>, .Platform<span class="nv">$dynlib</span>.ext, <span class="nv">sep</span><span class="o">=</span><span class="s2">""</span><span class="o">))</span>
<span class="o">&gt;</span> <span class="nb">source</span><span class="o">(</span><span class="s2">"rmath.R"</span><span class="o">)</span>
<span class="o">&gt;</span> cacheMetaData<span class="o">(</span>1<span class="o">)</span>
<span class="o">&gt;</span> sum<span class="o">(</span>88, 99<span class="o">)</span>
<span class="o">[</span>1] 187</code></pre></figure>

<p>we can use the same Rust function.</p>

<h3 id="conclusion">Conclusion</h3>

<p>Rust is a very promising language and as we have seen, using mature tools such as Swig it is very easy to tip your toe in the water and start including Rust libraries in your existing Python and r projects where you may need a perfromance boast or wish to take advantage of Rusts type safety and <a href="https://blog.Rust-lang.org/2015/04/10/Fearless-Concurrency.html" title="Fearless Concurrency">fearless concurrency</a>. The full project can be downloaded from <a href="https://github.com/prio/rmath" title="rmath github repo">github</a>.</p>


                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            this.page.url = '/rust-and-swig/';
                            this.page.identifier = '/rust-and-swig';
                            this.page.title = 'Rust and Swig';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://magpietech.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>


<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'true';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>


</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/freespeech/">
                <div class="post-card-image" style="background-image: url(/images/freespeech.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/freespeech/">
                <header class="post-card-header">
                    

                    <h2 class="post-card-title">Free Speech</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/static/integrate-django-with-keycloak">
                <div class="post-card-image" style="background-image: url(/images/Screen-Shot-2017-02-16-at-10-32-35.png)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/static/integrate-django-with-keycloak">
                <header class="post-card-header">
                    

                    <h2 class="post-card-title">Integrate Django with Keycloak</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p></p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                <span class="reading-time">
                    
                    
                      1 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="/">
            
                <img src="/assets/images/favicon.png" alt="Jonathan Harrington icon" />
            
            <span>Jonathan Harrington</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">Rust and Swig</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Rust+and+Swig&amp;url=https://blog.jonharrington.org/rust-and-swig/"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.jonharrington.org/rust-and-swig/"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="/">Jonathan Harrington</a> &copy; 2020</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyller/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    <a href="https://github.com/prio" target="_blank" rel="noopener">Github</a>
                    <a href="https://www.linkedin.com/in/jnharrington" target="_blank" rel="noopener">Linkedin</a>
                    <a href="https://twitter.com/jonathanharring" target="_blank" rel="noopener">Twitter</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
